<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Educational Agent</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body { font-family: Poppins; background: #f5f7fb; }
.hero {
  background: linear-gradient(135deg,#1e3c72,#2a5298);
  color:white; padding:80px; text-align:center;
}
.card { border-radius:15px; }
.icon { font-size:40px; animation: float 3s ease-in-out infinite; }
@keyframes float { 0%{transform:translateY(0)}50%{transform:translateY(-10px)}100%{transform:translateY(0)} }
</style>
</head>

<body>

<div class="hero">
  <h1>ðŸŽ“ Educational Agent</h1>
  <p>AI-powered learning management system</p>
</div>

<div class="container my-4">

<!-- DASHBOARD -->
<div class="row text-center mb-4">
  <div class="col-md-4">
    <div class="card p-3">
      <i class="bi bi-book icon text-primary"></i>
      <h5>Courses</h5>
      <h3 id="courseCount">0</h3>
    </div>
  </div>
  <div class="col-md-4">
    <div class="card p-3">
      <i class="bi bi-people icon text-success"></i>
      <h5>Students</h5>
      <h3 id="studentCount">0</h3>
    </div>
  </div>
  <div class="col-md-4">
    <div class="card p-3">
      <i class="bi bi-bar-chart icon text-info"></i>
      <h5>Analytics</h5>
      <h3>Live</h3>
    </div>
  </div>
</div>

<!-- ADD COURSE -->
<div class="card p-4 mb-4">
<h4>âž• Add Course</h4>
<input id="courseName" class="form-control mb-2" placeholder="Course name">
<input id="courseDuration" type="number" class="form-control mb-2" placeholder="Duration (days)">
<button class="btn btn-primary" onclick="addCourse()">Add Course</button>
<ul id="coursesList" class="list-group mt-3"></ul>
</div>

<!-- ADD STUDENT -->
<div class="card p-4 mb-4">
<h4>âž• Add Student</h4>
<input id="studentName" class="form-control mb-2" placeholder="Student name">
<input id="studentProgress" type="number" class="form-control mb-2" placeholder="Progress %">
<button class="btn btn-success" onclick="addStudent()">Add Student</button>
<ul id="studentsList" class="list-group mt-3"></ul>
</div>

<!-- RECOMMENDATION -->
<div class="card p-4 mb-4">
<h4>ðŸ’¡ Recommendation</h4>
<input id="recommendName" class="form-control mb-2" placeholder="Student name">
<button class="btn btn-info" onclick="getRecommendation()">Get Recommendation</button>
<p id="recommendResult" class="mt-2"></p>
</div>

<!-- AI -->
<div class="card p-4 mb-4">
<h4>ðŸ¤– AI Assistant</h4>
<input id="aiQuery" class="form-control mb-2" placeholder="Ask something">
<button class="btn btn-dark" onclick="askAI()">Ask AI</button>
<p id="aiResult" class="mt-2"></p>
</div>

<!-- CHART -->
<div class="card p-4">
<h4>ðŸ“Š Student Progress</h4>
<canvas id="progressChart"></canvas>
</div>

</div>

<script>
const BASE_URL = "https://edu-agent-nzfp.onrender.com";

async function addCourse() {
  await fetch(`${BASE_URL}/add_course?name=${courseName.value}&duration=${courseDuration.value}`);
  loadCourses();
}

async function addStudent() {
  await fetch(`${BASE_URL}/add_student?name=${studentName.value}&progress=${studentProgress.value}`);
  loadStudents();
  loadChart();
}

async function loadCourses() {
  const res = await fetch(`${BASE_URL}/courses`);
  const data = await res.json();
  courseCount.innerText = data.length;
  coursesList.innerHTML = data.map(c => `<li class="list-group-item">${c.name} (${c.duration} days)</li>`).join("");
}

async function loadStudents() {
  const res = await fetch(`${BASE_URL}/students`);
  const data = await res.json();
  studentCount.innerText = data.length;
  studentsList.innerHTML = data.map(s => `<li class="list-group-item">${s.name} - ${s.progress}%</li>`).join("");
}

async function getRecommendation() {
  const res = await fetch(`${BASE_URL}/recommend/${recommendName.value}`);
  const data = await res.json();
  recommendResult.innerText = data.recommendation || data.error;
}

async function askAI() {
  const res = await fetch(`${BASE_URL}/ai_recommend?query=${aiQuery.value}`);
  const data = await res.json();
  aiResult.innerText = data.answer;
}

async function loadChart() {
  const res = await fetch(`${BASE_URL}/students`);
  const data = await res.json();
  new Chart(document.getElementById("progressChart"), {
    type: "bar",
    data: {
      labels: data.map(s => s.name),
      datasets: [{ label: "Progress", data: data.map(s => s.progress) }]
    }
  });
}

loadCourses();
loadStudents();
loadChart();
</script>

</body>
</html>